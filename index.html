<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hunde‚ÄëKI & Interaktiver Stammbaum</title>

<style>
body {
font-family: Arial, sans-serif;
background-image: url('https://images.unsplash.com/photo-1518717758536-85ae29035b6d?auto=format&fit=crop&w=1400&q=80');
background-size: cover;
background-position: center;
color: #222;
margin: 0;
padding: 0;
}
header {
text-align: center;
padding: 18px;
font-size: 26px;
font-weight: bold;
background: rgba(0,0,0,0.7);
color: white;
}
.container {
display: flex;
flex-wrap: wrap;
justify-content: center;
}
.tree {
background: rgba(255,255,255,0.85);
border-radius: 12px;
padding: 18px;
margin: 15px;
width: 350px;
box-shadow: 0px 4px 12px rgba(0,0,0,0.2);
}
.node {
padding: 10px;
margin: 8px 0;
background: #1e90ff;
color: white;
border-radius: 8px;
cursor: pointer;
font-weight: bold;
text-align: center;
}
.child-nodes {
margin-top: 4px;
display: none;
}
.child-nodes .node {
background: #3ea0ff;
font-size: 14px;
}
.ki-panel {
background: rgba(255,255,255,0.9);
padding: 15px;
margin: 15px;
border-radius: 12px;
max-width: 600px;
width: 90%;
box-shadow: 0px 4px 15px rgba(0,0,0,0.25);
}
input, button {
width: 100%;
padding: 10px;
margin: 6px 0;
border-radius: 8px;
border: 1px solid #bbb;
}
button {
background: #1e90ff;
color: white;
border: none;
font-weight: bold;
cursor: pointer;
}
button:hover { background: #3ea0ff }
#previewImg, #previewVideo {
width: 100%;
margin-top: 10px;
border-radius: 8px;
}
#antwort {
margin-top: 12px;
background: #fafafa;
padding: 12px;
border-radius: 8px;
min-height: 60px;
color: #111;
}
@media (max-width: 768px) {
.tree, .ki-panel {
width: 95%;
}
}
</style>

</head>
<body>

<header>üêï Hunde KI & Interaktiver Stammbaum</header>

<div class="container">

<!-- üëá Interaktiver Stammbaum -->
<div class="tree">
<div class="node" data-info="Labrador Retriever sind freundlich, aktiv, familienbezogen.">
Labrador Retriever
<div class="child-nodes">
<div class="node" data-info="Ein sitzender Labrador nutzt Ruhe zum Beobachten.">Sitzend</div>
<div class="node" data-info="Ein stehender Labrador ist aufmerksam.">Stehend</div>
<div class="node" data-info="Labradore lieben spielen und apportieren.">Spielend</div>
</div>
</div>

<div class="node" data-info="Deutsche Sch√§ferhunde sind intelligent und vielseitig.">
Deutscher Sch√§ferhund
<div class="child-nodes">
<div class="node" data-info="Ein wachsender Sch√§ferhund zeigt Aufmerksamkeit.">Wachsam</div>
<div class="node" data-info="Knurren kann Unsicherheit oder Warnsignal bedeuten.">Knurrend</div>
<div class="node" data-info="Wenn er liegt, ist er entspannt oder beobachtend.">Liegt</div>
</div>
</div>

<div class="node" data-info="Franz√∂sische Bulldoggen sind freundlich & verspielt.">
Franz√∂sische Bulldogge
<div class="child-nodes">
<div class="node" data-info="Liegt oft gem√ºtlich und entspannt.">Liegt</div>
<div class="node" data-info="Spielend erkundet er Umgebung & Spa√ü.">Spielend</div>
<div class="node" data-info="Knurren kann Warnsignal oder √Ñrger zeigen.">Knurrend</div>
</div>
</div>

</div>

<!-- üëá KI Analyse Panel -->
<div class="ki-panel">
<input type="file" id="upload" accept="image/*,video/*">
<input type="text" id="search" placeholder="Stelle eine Frage √ºber deinen Hund">
<button id="analyzeBtn">Analysieren</button>

<!-- Vorschau -->
<img id="previewImg" style="display:none;">
<video id="previewVideo" controls style="display:none;"></video>

<div id="antwort"></div>
</div>

</div>

<script>
// ‚≠ê Interaktiver Baum anzeigen / ausblenden
document.querySelectorAll('.tree .node').forEach(node => {
node.addEventListener('click', () => {
const child = node.querySelector('.child-nodes');
if (child) {
child.style.display = child.style.display === 'block' ? 'none' : 'block';
}
// Info aus dem data-info anzeigen
const info = node.dataset.info;
if (info) {
document.getElementById('antwort').innerText = info;
}
});
});

// ‚≠ê KI Analyse
document.getElementById("analyzeBtn").addEventListener("click", analyse);

async function analyse() {
const fileInput = document.getElementById("upload");
const file = fileInput.files[0];
const frage = document.getElementById("search").value;
const output = document.getElementById("antwort");

if (!frage && !file) {
output.innerText = "Bitte eine Frage eingeben oder eine Datei hochladen.";
return;
}

output.innerText = "KI analysiert... üîç";

let imageData = null;
if (file) {
if (file.type.startsWith("video")) {
document.getElementById("previewImg").style.display = "none";
const vid = document.getElementById("previewVideo");
vid.style.display = "block";
vid.src = URL.createObjectURL(file);
imageData = await videoScreenshot(file);
} else {
document.getElementById("previewVideo").style.display = "none";
const img = document.getElementById("previewImg");
img.style.display = "block";
img.src = URL.createObjectURL(file);
imageData = await fileToBase64(file);
}
}

try {
const res = await fetch("/api/ask", {
method: "POST",
headers: {"Content-Type":"application/json"},
body: JSON.stringify({question: frage, image: imageData})
});
const json = await res.json();
const antwortText = json?.choices?.[0]?.message?.content || "Es konnte keine Antwort generiert werden.";
output.innerText = antwortText;
} catch (err) {
output.innerText = "Fehler bei der KI‚ÄëAnalyse.";
console.error(err);
}
}

async function fileToBase64(file) {
return new Promise(resolve => {
const reader = new FileReader();
reader.onload = () => resolve(reader.result);
reader.readAsDataURL(file);
});
}

async function videoScreenshot(videoFile) {
return new Promise(resolve => {
const video = document.createElement("video");
video.src = URL.createObjectURL(videoFile);
video.currentTime = 1;
video.muted = true;
video.addEventListener("loadeddata", () => {
const canvas = document.createElement("canvas");
canvas.width = video.videoWidth;
canvas.height = video.videoHeight;
const ctx = canvas.getContext("2d");
ctx.drawImage(video, 0, 0);
resolve(canvas.toDataURL("image/jpeg"));
});
});
}
</script>

</body>
</html>
